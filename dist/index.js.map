{"version":3,"file":"index.js","sources":["../src/util.js","../src/buildinRule.js","../src/config.js","../src/validate.js","../src/index.js"],"sourcesContent":["/* eslint-disable no-inner-declarations */\nconst toString = (obj) => Object.prototype.toString.call(obj)\n\nexport function isRegExp (obj) {\n  return toString(obj) === '[object RegExp]'\n}\n\nexport function isString (obj) {\n  return toString(obj) === '[object String]'\n}\n\nexport function isArray (obj) {\n  return toString(obj) === '[object Array]'\n}\n\nexport function isFunction (obj) {\n  return toString(obj) === '[object Function]'\n}\n\nexport function isNumber (obj) {\n  return toString(obj) === '[object Number]'\n}\n\nexport function isObject (obj) {\n  return obj != null && typeof obj === 'object'\n}\n\nexport function isEmpty (obj) {\n  if (obj == null) return true\n  if (typeof obj.length === 'number') return obj.length === 0\n  return false\n}\n\n/**\n * promise 顺序懒执行\n * @param tasks 函数列表，返回Promise\n * @returns {Promise}\n */\nexport function series (tasks) {\n  return new Promise((resolve, reject) => {\n    if (Array.isArray(tasks)) {\n      var result = []\n      var i = 0\n      var length = tasks.length\n      if (length === 0) {\n        return resolve(result)\n      }\n\n      run()\n\n      function run () {\n        var task = tasks[i]\n        Promise.resolve(task()).then((res) => {\n          result[i] = res\n          i++\n          if (i < length) {\n            run()\n          } else {\n            resolve(result)\n          }\n        }).catch(reject)\n      }\n    } else {\n      reject(new Error('Series Methods must be provided an Array'))\n    }\n  })\n}\n","export const rules = {}\n\n// 添加新的规则\nexport function addValidation (type, handler) {\n  rules[type] = handler\n}\n\n// 手机号(中国大陆)\naddValidation('mobile', function (value) {\n  return /^(\\+?0?86-?)?1[34578]\\d{9}$/.test(value)\n})\n\n// 钱\naddValidation('money', function (value) {\n  return /^(?!0\\.00)(?:0|[1-9]\\d*)(?:\\.\\d{1,2})?$/.test(value)\n})\n\n// ip\naddValidation('ip', function (value) {\n  return /^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i.test(value)\n})\n\n// 身份证\naddValidation('idcard', function (value) {\n  var isValid = true\n  var cityCode = {\n    11: '北京',\n    12: '天津',\n    13: '河北',\n    14: '山西',\n    15: '内蒙古',\n    21: '辽宁',\n    22: '吉林',\n    23: '黑龙江 ',\n    31: '上海',\n    32: '江苏',\n    33: '浙江',\n    34: '安徽',\n    35: '福建',\n    36: '江西',\n    37: '山东',\n    41: '河南',\n    42: '湖北 ',\n    43: '湖南',\n    44: '广东',\n    45: '广西',\n    46: '海南',\n    50: '重庆',\n    51: '四川',\n    52: '贵州',\n    53: '云南',\n    54: '西藏 ',\n    61: '陕西',\n    62: '甘肃',\n    63: '青海',\n    64: '宁夏',\n    65: '新疆',\n    71: '台湾',\n    81: '香港',\n    82: '澳门',\n    91: '国外 '\n  }\n\n  /* 15位校验规则： (dddddd yymmdd xx g)    g奇数为男，偶数为女\n   * 18位校验规则： (dddddd yyyymmdd xxx p) xxx奇数为男，偶数为女，p校验位\n\n   校验位公式：C17 = C[ MOD( ∑(Ci*Wi), 11) ]\n   i----表示号码字符从由至左包括校验码在内的位置序号\n   Wi 7 9 10 5 8 4 2 1 6 3 7 9 10 5 8 4 2 1\n   Ci 1 0 X 9 8 7 6 5 4 3 2\n   */\n  var rFormat = /^\\d{6}(18|19|20)\\d{2}(0[1-9]|1[012])(0[1-9]|[12]\\d|3[01])\\d{3}(\\d|X)$|^\\d{6}\\d{2}(0[1-9]|1[012])(0[1-9]|[12]\\d|3[01])\\d{3}$/\n\n  if (!rFormat.test(value) || !cityCode[value.substr(0, 2)]) {\n    isValid = false\n  } else if (value.length === 18) { // 18位身份证需要验证最后一位校验位\n    // 加权因子\n    var Wi = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2, 1]\n    // 校验字符\n    var Ci = '10X98765432'\n    // 加权求和\n    var sum = 0\n    for (var i = 0; i < 17; i++) {\n      sum += value.charAt(i) * Wi[i]\n    }\n    // 计算校验值\n    var C17 = Ci.charAt(sum % 11)\n    // 与校验位比对\n    if (C17 !== value.charAt(17)) {\n      isValid = false\n    }\n  }\n  return isValid\n})\n","import { isObject } from './util'\n// 全局错误信息提示\nexport const messages = {}\n\nexport function disposeMessages (obj) {\n  if (!isObject(obj)) return\n  let keys = Object.keys(obj)\n  keys.forEach((key) => {\n    messages[key] = obj[key]\n  })\n}\n","/* eslint-disable prefer-promise-reject-errors */\nimport {\n  isRegExp,\n  isString,\n  isArray,\n  isFunction,\n  isEmpty,\n  isNumber,\n  series\n} from './util'\n\nimport { rules } from './buildinRule'\nimport { messages } from './config'\n\n/**\n * 验证规则：\n * 1：字段为空，使用默认值default代替\n * 2：是否是required字段\n * 3：使用type判断字段类型\n * 4: 使用check判断是否通过\n */\nfunction validate (rule, ctx) {\n  return new Promise((resolve, reject) => {\n    let {\n      msg = messages,\n      required,\n      type,\n      check,\n      doVerify,\n      format\n    } = rule\n\n    let proxy = (err) => {\n      if (isString(err)) {\n        reject(msg[err] || messages[err] || '输入的值不合法')\n      } else {\n        reject(err.message)\n      }\n    }\n\n    let { value } = ctx\n\n    // 是否需要验证\n    if (isFunction(doVerify)) {\n      if (!doVerify.call(this, value, ctx)) {\n        return resolve()\n      }\n    }\n\n    // 对数据进行处理\n    if (isFunction(format)) {\n      value = format.call(this, value, ctx)\n    }\n\n    if (isEmpty(value)) {\n      // 必填\n      if (required) {\n        return proxy('required')\n      } else if (required === false) { // required=undefined 忽略，继续校验下面的规则\n        // 声明式非必填，为空直接跳过\n        return resolve()\n      }\n    }\n\n    // 验证类型，默认是string\n    let types = type\n    if (types) {\n      if (!isArray(types)) {\n        types = [types]\n      }\n    } else {\n      types = ['string']\n    }\n\n    let promises = types.map((type) => verify.bind(this, type, value, ctx, rule))\n\n    series(promises).then(() => {\n      if (isFunction(check)) {\n        var boo = check.call(this, value, ctx)\n        return isString(boo) ? reject(boo) : boo ? resolve() : proxy('check')\n      }\n\n      resolve()\n    }).catch(proxy)\n  })\n}\n\nfunction verify (type, value, ctx, rule) {\n  let {\n    minlength,\n    maxlength,\n    length,\n    min,\n    max,\n    range,\n    remote\n  } = rule\n\n  return new Promise((resolve, reject) => {\n    if (isString(type)) {\n      switch (type) {\n        case 'string':\n          value = String(value)\n          if (isNumber(minlength) && value.length < minlength) {\n            return reject('minlength')\n          }\n\n          if (isNumber(maxlength) && value.length > maxlength) {\n            return reject('maxlength')\n          }\n\n          if (isArray(length) && (value.length < length[0] || value.length > length[1])) {\n            return reject('length')\n          }\n\n          resolve()\n          break\n        case 'number':\n          if (!isNumber(value)) {\n            return reject('number')\n          }\n          if (isNumber(min) && value < min) {\n            return reject('min')\n          }\n          if (isNumber(max) && value > max) {\n            return reject('max')\n          }\n          if (isArray(range) && (value < range[0] || value > range[1])) {\n            return reject('range')\n          }\n\n          resolve()\n          break\n        case 'remote':\n          if (isFunction(remote)) {\n            remote.call(this, value, ctx, function (boo) {\n              isString(boo) ? reject(new Error(boo)) : boo ? resolve() : reject('remote')\n            })\n          }\n          break\n        case 'enum':\n          if (isArray(rule.enum) && rule.enum.indexOf(value) === -1) {\n            return reject('enum')\n          }\n\n          resolve()\n          break\n        default:\n          if (type in rules) {\n            var boo = rules[type].call(this, value, ctx)\n            return isString(boo) ? reject(new Error(boo)) : boo ? resolve() : reject(type)\n          }\n\n          resolve()\n          break\n      }\n    } else if (isRegExp(type)) {\n      if (!type.test(value)) {\n        return reject('regexp')\n      }\n\n      resolve()\n    }\n  })\n}\n\nexport default validate\n","import validate from './validate'\nimport { addValidation } from './buildinRule'\nimport { isObject } from './util'\nimport { disposeMessages } from './config'\n\nconst validator = {}\n\nvalidator.install = function (Vue, options = {}) {\n  if (options.autoHint) {\n    // 引入错误提示的css\n    require('./style.css')\n  }\n\n  let { field = 'errors' } = options\n\n  disposeMessages(options.messages)\n\n  let uid = 0\n\n  // 错误缓存对象\n  const cache = {}\n\n  Vue.errorCache = cache\n\n  // 给vue实例添加errors属性\n  Vue.mixin({\n    data () {\n      return {\n        [field]: {}\n      }\n    }\n  })\n\n  Vue.directive('validator', {\n    inserted: function (el, binding, vnode) {\n      const vm = vnode.context\n      const errorCache = cache[vm._uid] = cache[vm._uid] || {}\n      let id = uid++\n      el._erruid = id\n\n      // 对错误对象设置属性\n      // 从dom节点获取key作为属性\n      // 如果还不存在用指令的arg作为参数，如果存在多个这样的arg会新的会覆盖久的\n      // 建议都设置一个key\n      let value = binding.value\n      let key\n      if (!key) {\n        key = el.getAttribute('data-key')\n      }\n      if (!key) {\n        key = binding.arg\n      }\n      Vue.set(vm[field], key, undefined)\n\n      // 设置一份上下文, 用于通信\n      const context = errorCache[id] = {\n        // errors的key\n        key: key,\n        // 当前绑定的节点\n        target: el,\n        // 错误信息\n        msg: undefined,\n        // 保存的值\n        value: value,\n        oldValue: value,\n        // 验证规则\n        rule: binding.arg,\n        // 验证函数\n        check: function () {\n          vm.errors[key] = this.msg\n\n          // 对错误进行展示\n          if (options.autoHint) {\n            if (this.msg) {\n              this.msgEl.innerHTML = this.msg\n              this.el.style.display = null\n            } else {\n              this.msgEl.innerHTML = ''\n              this.el.style.display = 'none'\n            }\n          }\n        }\n      }\n\n      if (options.autoHint) {\n        context.el = autoHint.call(this, el)\n        context.msgEl = context.el.querySelector('.err-tip-msg')\n      }\n    },\n    update: function (el, binding, vnode) {\n      const vm = vnode.context\n      if (!vm.__validationModel) return\n\n      const errorCache = cache[vm._uid]\n      const context = errorCache[el._erruid]\n      context.value = binding.value\n      context.oldValue = binding.oldValue\n      // 刚进页面和值没有更改不进行校验,但对于引用类型不拦截\n      if (context.value === context.oldValue && !isObject(context.value)) return\n\n      // 验证规则\n      var validationModel = vm.__validationModel[binding.arg]\n\n      if (validationModel) {\n        validate.call(vm, validationModel, context).then(() => {\n          context.msg = undefined\n          context.check()\n        }).catch((err) => {\n          context.msg = err\n          context.check()\n        })\n      }\n    },\n    unbind: function (el, binding, vnode) {\n      const context = cache[vnode.context._uid][el._erruid]\n      delete vnode.context[field][context.key]\n      delete cache[vnode.context._uid][el._erruid]\n    }\n  })\n\n  // 验证一个规则\n  Vue.prototype.$validate = function (ruleName, value) {\n    return new Promise((resolve, reject) => {\n      if (!this.__validationModel || !(ruleName in this.__validationModel)) {\n        resolve()\n      } else {\n        validate.call(this, this.__validationModel[ruleName], { value: value }).then(resolve).catch((err) => {\n          reject(new Error('验证失败：' + err))\n        })\n      }\n    })\n  }\n\n  // 初始化验证规则\n  // 不执行该方法,则不会进行验证\n  Vue.prototype.$initValidate = function (model) {\n    if (model) {\n      this.__validationModel = model\n    }\n  }\n\n  // 验证所有规则是否通过\n  Vue.prototype.$isValid = function () {\n    return new Promise((resolve, reject) => {\n      if (!this.__validationModel) {\n        resolve()\n      } else {\n        // 实例对应对错误缓存对象\n        const errCache = cache[this._uid]\n        const promises = Object.keys(errCache).map((key) => new Promise((resolve, reject) => {\n          const context = errCache[key]\n          // 验证规则\n          const validationModel = this.__validationModel[context.rule]\n          if (validationModel) {\n            validate.call(this, validationModel, context).then(() => {\n              context.msg = undefined\n              context.check()\n              resolve()\n            }).catch((err) => {\n              context.msg = err\n              context.check()\n              reject(new Error('验证失败：' + err))\n            })\n          } else {\n            resolve()\n          }\n        }))\n\n        Promise.all(promises).then(() => { resolve() }).catch(reject)\n      }\n    })\n  }\n}\n\n// 自动提示\nfunction autoHint (el) {\n  var hint = document.createElement('div')\n  hint.setAttribute('class', 'err-tip-wrap')\n  hint.innerHTML = '<div class=\"err-tip\"><div class=\"err-tip-msg\"></div></div>'\n  hint.style.display = 'none'\n  before(hint, el)\n  return hint\n}\n\nfunction before (el, target) {\n  target.parentNode.insertBefore(el, target)\n}\n\nvalidator.addValidation = addValidation\n\nexport default validator\n"],"names":["toString","obj","Object","prototype","call","isRegExp","isString","isArray","isFunction","isNumber","isObject","isEmpty","length","series","tasks","Promise","resolve","reject","Array","run","task","i","then","res","result","catch","Error","rules","addValidation","type","handler","value","test","isValid","cityCode","rFormat","substr","Wi","Ci","sum","charAt","C17","messages","disposeMessages","keys","forEach","key","validate","rule","ctx","msg","required","check","doVerify","format","proxy","err","message","types","promises","map","verify","bind","boo","minlength","maxlength","min","max","range","remote","String","enum","indexOf","validator","install","Vue","options","autoHint","field","uid","cache","errorCache","mixin","directive","el","binding","vnode","vm","context","_uid","id","_erruid","getAttribute","arg","set","undefined","errors","msgEl","innerHTML","style","display","querySelector","__validationModel","oldValue","validationModel","$validate","ruleName","$initValidate","model","$isValid","errCache","all","hint","document","createElement","setAttribute","before","target","parentNode","insertBefore"],"mappings":"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"}